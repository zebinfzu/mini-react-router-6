# 建立 mini-react-router

本节要实现的内容：

1. 查看源文件/src/1.app.js
2. 使用 min-react-router 中的 BrowserRouter，Routes，Route 三个 Component 实现基本的路由

源码逻辑：

1. index.js 管理向外导出所有接口

   ```js
   import BrowserRouter from "./BrowserRouter";
   import Routes from "./Routes";
   import Route from "./Route";
   export { BrowserRouter, Routes, Route };
   ```

2. BrowserRouter，目前只是将所有的子节点显示出来
   ```jsx
   export default function BrowserRouter({ children }) {
     // 将传入的React元素的子元素全部返回
     return children;
   }
   ```
3. Routes，管理当 location 变化的时候，要遍历自己所有的子节点 Route，显示匹配上的 Route，本质起到 if else 的作用

   ```jsx
   import React from "react";
   import { useRoutes } from "./hooks";
   // 获取到里面所有的子节点
   export default function Routes({ children }) {
     let routes = [];
     // 遍历所有的子节点将子节点处理为包含element和和path的对象
     React.Children.forEach(children, (child) => {
       let route = { element: child.props.element, path: child.props.path };
       routes.push(route);
     });
     // 自定义hook函数useRoutes根据location来做渲染
     return useRoutes(routes);
   }
   ```

4. hooks.js 管理所有的自定义 hook 函数

   ```jsx
   export function useRoutes(routes) {
     console.log("routes", routes); // log
     // 获取path
     let pathname = window.location.pathname; // 简单粗暴使用全局对象下的location
     // 通过map方法获取要渲染的route
     return routes.map((route) => {
       let match = pathname === route.path || pathname === "/" + route.path;
       return match ? route.element : null;
     });
   }
   ```
